import{a$ as B,I as c,bF as Ri,a9 as a,b3 as G,ae as N,ag as xi,be as Li,b2 as ki,bg as j,bh as ci,bj as gi,b8 as Oi,am as Ui,ai as Ei}from"./index-7baedad1.js";import{d as Vi}from"./blog-ab74bd07.js";import{c as Fi,a as r,d as qi,F as yi,g as Ii,u as Ni,e as pi,R as b,C as Bi}from"./form-provider-f0797274.js";import{o as Ci,G as Q,C as ai}from"./yup-573c9287.js";import{d as $i,a as Pi}from"./RemoveCircleOutline-7d32947f.js";import{R as ti,A as Wi,a as zi,b as Hi}from"./attributeReduce-55c83204.js";import{C as Gi}from"./numeral-64476a1d.js";import{L as Ki}from"./LoadingButton-5b466cf8.js";import"./axios-cb1c23e4.js";import"./TextField-ea5a8ca7.js";import"./createSvgIcon-43748fa8.js";const Di=({avenues:i,avenue:s,avenuesDispatch:I,setAllValue:$,listName:W})=>{const[z,X]=c.useState(null),[oi,Y]=c.useState(null),[li,ei]=c.useState(!1),[di,mi]=c.useState(!1),{setCallBack:ni}=c.useContext(Ri),J=Fi().shape({name:r().min(4).max(50).required("name is required"),title:r().min(4).max(50).required("title is required"),desc:r().min(10).max(5e3).required("Description is required"),color:r().min(4).max(50).required("color is required"),img:r().max(500).required("Image is required"),descImg:r().max(500).required("Avenues Description Image is required")}),p=c.useMemo(()=>({name:(s==null?void 0:s.name)||"",title:(s==null?void 0:s.title)||"",desc:(s==null?void 0:s.desc)||"",color:(s==null?void 0:s.color)||"",img:(s==null?void 0:s.img)||"",descImg:(s==null?void 0:s.descImg)||""}),[s]),H=qi({resolver:async(e,l,d)=>await Ci(J)(e,l,d),defaultValues:p}),{reset:Z,watch:P,setValue:F,handleSubmit:ri,formState:{isSubmitting:Si,isValid:t}}=H,E=P(),A=ri(async e=>{let l;if(li){s!=null&&s.img&&await axiosReq.post("/deleteFile",{fileUrl:s.img});const d=new FormData;E.img&&(d.append("file",E.img),(await axiosReq.post("/uploadFile/Avenues",d,{headers:{"Content-Type":"multipart/form-data"}})).data.data)}if(di){s!=null&&s.descImg&&await axiosReq.post("/deleteFile",{fileUrl:s.descImg});const d=new FormData;if(E.descImg){d.append("file",E.descImg);const g=await axiosReq.post("/uploadFile/Avenues",d,{headers:{"Content-Type":"multipart/form-data"}}),{fileUrl:w}=g.data.data;l=w,F("descImg",l)}}});c.useEffect(()=>{s&&(Z(p),ni(A))},[s,p,Z]);const K=e=>{e.preventDefault();const{value:l,id:d,name:g}=e.target,w=i.map(o=>o.id==d?{...o,[g]:l}:o);$(W,w),I({type:"edit",newAvenues:w})},M=(e,l,d)=>{const g=e?e[0]:null,w=i.findIndex(m=>m.id==l.id),o=i.map((m,h)=>h===w?{...m,[d]:g}:m);$(W,o),I({type:"edit",newAvenues:o,index:w})},u=c.useCallback(e=>{const l=e[0];ei(!0);const d=Object.assign(l,{preview:URL.createObjectURL(l)});X(l),l&&F("img",d,{shouldValidate:!0})},[F]),v=c.useCallback(()=>{F("img",null),X(null)},[F]),ii=c.useCallback(e=>{const l=e[0];mi(!0);const d=Object.assign(l,{preview:URL.createObjectURL(l)});Y(l),l&&F("descImg",d,{shouldValidate:!0})},[F]),V=c.useCallback(()=>{F("descImg",null),Y(null)},[F]),_=e=>{const{id:l}=e.target,d=i.filter(g=>g.id!=l);$(W,d),I({type:"remove",id:l,newAvenues:d})};return a.jsx(yi,{methods:H,onSubmit:A,children:a.jsxs(G,{spacing:3,sx:{p:3},children:[a.jsx(N,{variant:"subtitle2",children:E.name}),a.jsx(ti,{id:s.id,onChange:K,name:"name",label:"Avenue Name"}),a.jsx(ti,{id:s.id,onChange:K,name:"title",label:"Avenue Title"}),a.jsx(ti,{id:s.id,onChange:K,type:"text",name:"desc",label:"Avenue description",multiline:!0,rows:3}),a.jsx(ti,{id:s.id,onChange:K,name:"color",label:"Avenue Color"}),a.jsxs(G,{spacing:1.5,children:[a.jsx(N,{variant:"subtitle2",children:"Image"}),a.jsx(Ii,{name:"img",maxSize:3145728,onDrop:e=>{M(e,s,"img"),u(e)},onDelete:e=>{M(null,s,"img"),v(e)},file:E.img||z})]}),a.jsxs(G,{spacing:1.5,children:[a.jsx(N,{variant:"subtitle2",children:"Description Image"}),a.jsx(Ii,{name:"descImg",maxSize:3145728,onDrop:e=>{ii(e),M(e,s,"descImg")},onDelete:e=>{V(e),M(null,s,"descImg")},file:E.descImg||oi})]}),a.jsx(xi,{id:s.id,variant:"outlined",sx:{color:"#FFFFFF",backgroundColor:"#b1a9a9","&:hover":{backgroundColor:"#b1a9a9",color:"red"}},startIcon:a.jsx($i,{}),onClick:_,children:"Remove"})]})})};Di.propTypes={avenues:B.array.isRequired,avenue:B.object.isRequired,avenuesDispatch:B.func.isRequired,setAllValue:B.func.isRequired,listName:B.string.isRequired};const si=({avenues:i,avenuesDispatch:s,setAllValue:I,listName:$})=>{const W=()=>{I($,[...i,{id:i==null?void 0:i.length}]),s({type:"add",id:i==null?void 0:i.length})};return a.jsxs(a.Fragment,{children:[i==null?void 0:i.map(z=>a.jsx(Di,{id:z.id,avenue:z,avenues:i,avenuesDispatch:s,setAllValue:I,listName:$},z.id)),a.jsx(xi,{variant:"outlined",sx:{color:"#fff",backgroundColor:"#212B36","&:hover":{backgroundColor:"#454F5B"}},startIcon:a.jsx(Pi,{}),onClick:W,children:"إضافة طلب جديد"})]})};si.propTypes={avenues:B.array.isRequired,avenuesDispatch:B.func.isRequired,setAllValue:B.func.isRequired,listName:B.string.isRequired};function Ti({currentAvenues:i}){var u,v,ii;const s=Li(),I=ki("up","md"),{enqueueSnackbar:$}=Ni(),W=((u=i==null?void 0:i.lang)==null?void 0:u.ar.Avenues)||[],z=((v=i==null?void 0:i.lang)==null?void 0:v.en.Avenues)||[],X=((ii=i==null?void 0:i.lang)==null?void 0:ii.cr.Avenues)||[],[oi,Y]=c.useReducer(Wi,W),[li,ei]=c.useReducer(zi,z),[di,mi]=c.useReducer(Hi,X),ni=Fi().shape({titleOne_ar:r().min(4).max(50).required("الجزء الأول من العنوان مطلوب باللغة العربية"),titleOne_en:r().min(4).max(50).required("English First section of title is required"),titleOne_cr:r().min(4).max(50).required("kurd First section of title is required"),span_ar:r().min(4).max(50).required("الكلمة المميزة مطلوبة بالعربية"),span_en:r().min(4).max(50).required("English Special Word is required"),span_cr:r().min(4).max(50).required("kurd Special Word is required"),titleTow_ar:r().min(4).max(50).required("الجزء الثاني من العنوان مطلوب باللغة العربية"),titleTow_en:r().min(4).max(50).required("English Second section of title is required"),titleTow_cr:r().min(4).max(50).required("kurd Second section of title is required"),description_ar:r().min(10).max(5e3).required("الوصف مطلوب باللغة العربية"),description_en:r().min(10).max(5e3).required("English Description is required"),description_cr:r().min(10).max(5e3).required("kurd Description is required"),avenuesList_ar:pi().min(1).max(5).required("Avenues List مطلوب باللغة العربية"),avenuesList_en:pi().min(1).max(5).required("English Avenues List"),avenuesList_cr:pi().min(1).max(5).required("Kurd Avenues List")}),J=c.useMemo(()=>{var V,_,e,l,d,g,w,o,m,h,q,y,C,D,T,S,R,L,k,O,U,n,x,f,fi,hi,ji,_i,wi,bi;return{titleOne_ar:((_=(V=i==null?void 0:i.lang)==null?void 0:V.ar)==null?void 0:_.titleOne)||"",titleOne_en:((l=(e=i==null?void 0:i.lang)==null?void 0:e.en)==null?void 0:l.titleOne)||"",titleOne_cr:((g=(d=i==null?void 0:i.lang)==null?void 0:d.cr)==null?void 0:g.titleOne)||"",titleTow_ar:((o=(w=i==null?void 0:i.lang)==null?void 0:w.ar)==null?void 0:o.titleTow)||"",titleTow_en:((h=(m=i==null?void 0:i.lang)==null?void 0:m.en)==null?void 0:h.titleTow)||"",titleTow_cr:((y=(q=i==null?void 0:i.lang)==null?void 0:q.cr)==null?void 0:y.titleTow)||"",span_ar:((D=(C=i==null?void 0:i.lang)==null?void 0:C.ar)==null?void 0:D.span)||"",span_en:((S=(T=i==null?void 0:i.lang)==null?void 0:T.en)==null?void 0:S.span)||"",span_cr:((L=(R=i==null?void 0:i.lang)==null?void 0:R.cr)==null?void 0:L.span)||"",description_ar:((O=(k=i==null?void 0:i.lang)==null?void 0:k.ar)==null?void 0:O.desc)||"",description_en:((n=(U=i==null?void 0:i.lang)==null?void 0:U.en)==null?void 0:n.desc)||"",description_cr:((f=(x=i==null?void 0:i.lang)==null?void 0:x.cr)==null?void 0:f.desc)||"",avenuesList_ar:((hi=(fi=i==null?void 0:i.lang)==null?void 0:fi.ar)==null?void 0:hi.Avenues)||"",avenuesList_en:((_i=(ji=i==null?void 0:i.lang)==null?void 0:ji.en)==null?void 0:_i.Avenues)||"",avenuesList_cr:((bi=(wi=i==null?void 0:i.lang)==null?void 0:wi.cr)==null?void 0:bi.Avenues)||""}},[i]),p=qi({resolver:async(V,_,e)=>await Ci(ni)(V,_,e),defaultValues:J}),{reset:H,watch:Z,setValue:P,handleSubmit:F,formState:{isSubmitting:ri,isValid:Si}}=p,t=Z();c.useEffect(()=>{i&&H(J)},[i,J,H]);const E=F(async V=>{var _,e;try{const l=await Promise.all(t==null?void 0:t.avenuesList_ar.map(async(o,m)=>{var h,q,y,C,D,T,S,R,L,k,O,U;if(typeof o.img=="object"){(y=(q=(h=i==null?void 0:i.lang)==null?void 0:h.ar)==null?void 0:q.Avenues[m])!=null&&y.img&&await j.post("/deleteFile",{fileUrl:(T=(D=(C=i==null?void 0:i.lang)==null?void 0:C.ar)==null?void 0:D.Avenues[m])==null?void 0:T.img});const n=new FormData;if(o.img){n.append("file",o.img);const x=await j.post("/uploadFile/avenues",n,{headers:{"Content-Type":"multipart/form-data"}}),{fileUrl:f}=x.data.data;o.img=f}}if(typeof o.descImg=="object"){(L=(R=(S=i==null?void 0:i.lang)==null?void 0:S.ar)==null?void 0:R.Avenues[m])!=null&&L.descImg&&await j.post("/deleteFile",{fileUrl:(U=(O=(k=i==null?void 0:i.lang)==null?void 0:k.ar)==null?void 0:O.Avenues[m])==null?void 0:U.descImg});const n=new FormData;if(o.descImg){n.append("file",o.descImg);const x=await j.post("/uploadFile/avenues",n,{headers:{"Content-Type":"multipart/form-data"}}),{fileUrl:f}=x.data.data;o.descImg=f}}return o})),d=await Promise.all(t==null?void 0:t.avenuesList_en.map(async(o,m)=>{var h,q,y,C,D,T,S,R,L,k,O,U;if(typeof o.img=="object"){(y=(q=(h=i==null?void 0:i.lang)==null?void 0:h.en)==null?void 0:q.Avenues[m])!=null&&y.img&&await j.post("/deleteFile",{fileUrl:(T=(D=(C=i==null?void 0:i.lang)==null?void 0:C.en)==null?void 0:D.Avenues[m])==null?void 0:T.img});const n=new FormData;if(o.img){n.append("file",o.img);const x=await j.post("/uploadFile/avenues",n,{headers:{"Content-Type":"multipart/form-data"}}),{fileUrl:f}=x.data.data;o.img=f}}if(typeof o.descImg=="object"){(L=(R=(S=i==null?void 0:i.lang)==null?void 0:S.en)==null?void 0:R.Avenues[m])!=null&&L.descImg&&await j.post("/deleteFile",{fileUrl:(U=(O=(k=i==null?void 0:i.lang)==null?void 0:k.en)==null?void 0:O.Avenues[m])==null?void 0:U.descImg});const n=new FormData;if(o.descImg){n.append("file",o.descImg);const x=await j.post("/uploadFile/avenues",n,{headers:{"Content-Type":"multipart/form-data"}}),{fileUrl:f}=x.data.data;o.descImg=f}}return o})),g=await Promise.all(t==null?void 0:t.avenuesList_cr.map(async(o,m)=>{var h,q,y,C,D,T,S,R,L,k,O,U;if(typeof o.img=="object"){(y=(q=(h=i==null?void 0:i.lang)==null?void 0:h.cr)==null?void 0:q.Avenues[m])!=null&&y.img&&await j.post("/deleteFile",{fileUrl:(T=(D=(C=i==null?void 0:i.lang)==null?void 0:C.cr)==null?void 0:D.Avenues[m])==null?void 0:T.img});const n=new FormData;if(o.img){n.append("file",o.img);const x=await j.post("/uploadFile/avenues",n,{headers:{"Content-Type":"multipart/form-data"}}),{fileUrl:f}=x.data.data;o.img=f}}if(typeof o.descImg=="object"){(L=(R=(S=i==null?void 0:i.lang)==null?void 0:S.cr)==null?void 0:R.Avenues[m])!=null&&L.descImg&&await j.post("/deleteFile",{fileUrl:(U=(O=(k=i==null?void 0:i.lang)==null?void 0:k.cr)==null?void 0:O.Avenues[m])==null?void 0:U.descImg});const n=new FormData;if(o.descImg){n.append("file",o.descImg);const x=await j.post("/uploadFile/avenues",n,{headers:{"Content-Type":"multipart/form-data"}}),{fileUrl:f}=x.data.data;o.descImg=f}}return o}));await P("avenuesList_ar",l),await P("avenuesList_en",d),await P("avenuesList_cr",g);const w={lang:{ar:{titleOne:t==null?void 0:t.titleOne_ar,titleTow:t==null?void 0:t.titleTow_ar,span:t==null?void 0:t.span_ar,desc:t==null?void 0:t.description_ar,Avenues:t.avenuesList_ar},en:{titleOne:t==null?void 0:t.titleOne_en,titleTow:t==null?void 0:t.titleTow_en,span:t==null?void 0:t.span_en,desc:t==null?void 0:t.description_en,Avenues:t.avenuesList_en},cr:{titleOne:t==null?void 0:t.titleOne_cr,titleTow:t==null?void 0:t.titleTow_cr,span:t==null?void 0:t.span_cr,desc:t==null?void 0:t.description_cr,Avenues:t.avenuesList_cr}}};await j.put("/edit/avenues",w),H(),$("Update success!"),window.location.reload(),ci.success("Avenues's Updated Successfully.")}catch(l){ci.error(((e=(_=l==null?void 0:l.response)==null?void 0:_.data)==null?void 0:e.msg)||"Something went wrong!"),console.error(l)}}),A=a.jsxs(a.Fragment,{children:[I&&a.jsxs(Q,{md:4,children:[a.jsx(N,{variant:"h6",sx:{mb:.5},children:"Texts"}),a.jsx(N,{variant:"body2",sx:{color:"text.secondary"},children:"Title, description, buttons..."})]}),a.jsx(Q,{xs:12,md:8,children:a.jsxs(Gi,{children:[!I&&a.jsx(ai,{title:"Texts"}),a.jsx(ai,{title:"Arabic Text"}),a.jsxs(G,{spacing:3,sx:{p:3},children:[a.jsx(b,{name:"titleOne_ar",label:"الجزء الأول من العنوان بالعربية",sx:{direction:"rtl"}}),a.jsx(b,{name:"span_ar",label:"الكلمة المميزة بالعربية",sx:{direction:"rtl"}}),a.jsx(b,{name:"titleTow_ar",label:"الجزء الثاني من العنوان بالعربية",sx:{direction:"rtl"}}),a.jsx(b,{type:"text",name:"description_ar",label:"الوصف بالعربية",multiline:!0,rows:3,sx:{direction:"rtl"}}),a.jsxs(G,{spacing:0,sx:{p:3},children:[a.jsx(N,{variant:"h6",sx:{mb:.5},children:"Avenues"}),a.jsx(si,{setAllValue:P,avenues:oi,avenuesDispatch:Y,listName:"avenuesList_ar"})]}),a.jsx(ai,{title:"English Text"}),a.jsx(b,{name:"titleOne_en",label:"English First section of title"}),a.jsx(b,{name:"span_en",label:"english Special Word"}),a.jsx(b,{name:"titleTow_en",label:"English Second section of title"}),a.jsx(b,{type:"text",name:"description_en",label:"english description",multiline:!0,rows:3}),a.jsxs(G,{spacing:0,sx:{p:3},children:[a.jsx(N,{variant:"h6",sx:{mb:.5},children:"Avenues"}),a.jsx(si,{setAllValue:P,avenues:li,avenuesDispatch:ei,listName:"avenuesList_en"})]}),a.jsx(ai,{title:"Kurd Text"}),a.jsx(b,{name:"titleOne_cr",label:"kurd First section of title"}),a.jsx(b,{name:"span_cr",label:"kurd Special Word"}),a.jsx(b,{name:"titleTow_cr",label:"kurd Second section of title"}),a.jsx(b,{type:"text",name:"description_cr",label:"kurd First description",multiline:!0,rows:3}),a.jsxs(G,{spacing:0,sx:{p:3},children:[a.jsx(N,{variant:"h6",sx:{mb:.5},children:"Avenues"}),a.jsx(si,{setAllValue:P,avenues:di,avenuesDispatch:mi,listName:"avenuesList_cr"})]})]})]})})]}),K=a.jsxs(a.Fragment,{children:[I&&a.jsx(Q,{md:4}),a.jsxs(Q,{xs:12,md:8,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[a.jsx(xi,{color:"inherit",variant:"outlined",size:"large",onClick:()=>{H(),s.push(gi.dashboard.root)},children:"cancel"}),a.jsx(Ki,{type:"submit",variant:"contained",size:"large",loading:ri,sx:{ml:2},onClick:async()=>{var V,_;await E(),(V=p==null?void 0:p.formState)!=null&&V.errors&&Object.keys((_=p==null?void 0:p.formState)==null?void 0:_.errors).map(l=>{var d;ci.error((d=p==null?void 0:p.formState)==null?void 0:d.errors[l].message)})},children:"Save Avenues"})]})]}),M=a.jsx(a.Fragment,{children:I&&a.jsxs(Q,{md:4,children:[a.jsx(N,{variant:"h6",sx:{mb:.5},children:"Image"}),a.jsx(N,{variant:"body2",sx:{color:"text.secondary"},children:"hero Section Image..."})]})});return a.jsx(yi,{methods:p,onSubmit:E,children:a.jsxs(Q,{container:!0,spacing:3,children:[A,M,K]})})}Ti.propTypes={currentAvenues:B.object};function Mi(){const i=Oi(),{avenues:s}=Vi();return a.jsxs(Ui,{maxWidth:i.themeStretch?!1:"lg",children:[a.jsx(Bi,{heading:"Edit Avenues Section",links:[{name:"Dashboard",href:gi.dashboard.root},{name:"avenues",href:gi.dashboard.service.root}],sx:{mb:{xs:3,md:5}}}),s&&a.jsx(Ti,{currentAvenues:s})]})}function sa(){return a.jsxs(a.Fragment,{children:[a.jsx(Ei,{children:a.jsx("title",{children:" Dashboard: Avenues Edit"})}),a.jsx(Mi,{})]})}export{sa as default};
